<!doctype html>

<html>
	<head>
		<title>Page Title</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="initial-scale=1.0">
		<link rel="stylesheet" href="styles/styles.css">
		<style>
			
		</style>
	</head>
	<body>
		<div id="tapete" class="tapete">
			<div id="baraja">
				<div id="carta1" class="carta"><img id="naipe1"src="deck/anverso.png" alt=""></div>
				<div id="carta2" class="carta"><img id="naipe2"src="deck/anverso.png" alt=""></div>
				<div id="carta3" class="carta"><img id="naipe3"src="deck/anverso.png" alt=""></div>
				<div id="carta4" class="carta"><img id="naipe4"src="deck/anverso.png" alt=""></div>
				<div id="carta5" class="carta"><img id="naipe5"src="deck/anverso.png" alt=""></div>
				<div id="carta6" class="carta"><img id="naipe6"src="deck/anverso.png" alt=""></div>
				<div id="carta7" class="carta"><img id="naipe7"src="deck/anverso.png" alt=""></div>
				<div id="carta8" class="carta"><img id="naipe8"src="deck/anverso.png" alt=""></div>
				<div id="carta9" class="carta"><img id="naipe9" src="deck/anverso.png" alt=""></div>
				<div id="carta10" class="carta"><img id="naipe10" src="deck/anverso.png" alt=""></div>
			</div>
			<div id="credito_jugador" class="credito_jugador">
				<div id="credito_jugador_texto">
					<p>Crédito:</p>
				</div>
				<div id="credito_jugador_valor">
					<p>500</p>
				</div>
			</div>
			<button id="nueva_partida" class="nueva_partida">
				Nueva Partida
			</button>
			<button id="nueva_apuesta" class="nueva_apuesta">
				Nueva Apuesta
			</button>
			<button id="pedir_carta" class="pedir_carta">
				Pedir Carta
			</button>
			<button id="plantarse" class="plantarse">
				Plantarse
			</button>
			<button id="salir" class="salir">
				Salir
			</button>


		</div>

		
	</body>
	<script>

		var credito_jugador = 500;
		let apuesta;
		let credito_jugador_valor = document.getElementById("credito_jugador_valor");
		let credito_jugador_texto = document.getElementById("credito_jugador_texto");
		let carta1 = document.getElementById("carta1");
		let carta2 = document.getElementById("carta2");
		let carta3 = document.getElementById("carta3");
		let carta4 = document.getElementById("carta4");
		let carta5 = document.getElementById("carta5");
		let carta6 = document.getElementById("carta6");
		let carta7 = document.getElementById("carta7");
		let carta8 = document.getElementById("carta8");
		let carta9 = document.getElementById("carta9");
		let carta10 = document.getElementById("carta10");
		let naipe1 = document.getElementById("naipe1");
		let naipe2 = document.getElementById("naipe2");
		let naipe3 = document.getElementById("naipe3");
		let naipe4 = document.getElementById("naipe4");
		let naipe5 = document.getElementById("naipe5");
		let naipe6 = document.getElementById("naipe6");
		let naipe7 = document.getElementById("naipe7");
		let naipe8 = document.getElementById("naipe8");
		let naipe9 = document.getElementById("naipe9");
		let naipe10 = document.getElementById("naipe10");
		let baraja = document.getElementById("baraja");
		let nueva_partida = document.getElementById("nueva_partida");
		let nueva_apuesta = document.getElementById("nueva_apuesta");
		let pedir_carta = document.getElementById("pedir_carta");
		let plantarse = document.getElementById("plantarse");
		let salir = document.getElementById("salir");
		let tapete = document.getElementById("tapete");
		var inicioPartida;
		var carta;
		var palo;
		var valor;
		var id;
		let cartaJugador1;
		let cartaJugador2;
		// let cartaJugador3;
		// let cartaJugador4;
		// let cartaJugador5;
		let cartaBanca1;
		let cartaBanca2;
		
		class cartaJuego{
				constructor(palo, carta){
				this.palo = palo;
				this.carta = carta;
				this.valor = valor;
				this.id = id;
				this.owned = false;
			}
		}

		nueva_partida.addEventListener("click", nuevaPartida);
		pedir_carta.addEventListener("click", pideCarta);	
		
		function nuevaPartida() {
			if (credito_jugador > 0) {
				apuesta = prompt("¿Cuanto quieres apostar?");
				credito_jugador_valor.innerHTML = credito_jugador - apuesta;
				barajar();
				inicioPartida = true;
		}}

		function barajar() {
			for (var i = 0; i < 3; i++) {                                  							//Bucle FOR con 3 iteraciones para barajar la baraja
				setTimeout(function() {																//Cada iteracion se ejecuta una vez mas tarde que la anterior
					carta9.classList.add("barajar1");												//Añade la clase barajar1 a la carta9
					carta9.addEventListener("animationend", function(){								//Al finalizar la animacion de la carta9
						carta9.classList.remove("barajar1");										//Elimina la clase barajar1 de la carta9
					});
					carta9.addEventListener("animationend", function(){								//Al finalizar la animacion de la carta9
						carta9.classList.add("barajar2");											//Añade la clase barajar2 a la carta9
					});
					carta9.classList.remove("barajar2");											//Elimina la clase barajar2 de la carta9
				}, i * 1000);																		//Cada iteracion se ejecuta una vez mas tarde que la anterior
			}
				nueva_partida.disabled = true;														//Desactiva el boton nueva partida
				setTimeout(function() {										
					nueva_partida.classList.add("disabled");										//Añade la clase disabled a el boton nueva partida																//Inicializa la variable inicioPartida a 1
					mostrarBotones(inicioPartida);													//Llamada a la funcion mostrarBotones
				}, 3000);
		}

			function randomizarCarta(){																//Funcion para generar un numero aleatorio entre 1 y 13
				carta = Math.floor(Math.random() * 12) + 1; 										//Genera un numero aleatorio entre 1 y 13													
				if(carta>10){
					valor=10;
				}else {
					valor=carta;
				}
				
			}

			function randomizarPalo(){																//Funcion para generar un numero aleatorio entre 1 y 4
				palo = Math.floor(Math.random() * 4) + 1;											//Genera un numero aleatorio entre 1 y 4
				if (palo == 1){												
					palo = "cora"																	//Si el numero aleatorio es 1, el palo es corazones
				}else if (palo == 2){
					palo = "diaman"																	//Si el numero aleatorio es 2, el palo es diamantes
				}else if (palo == 3){
					palo = "trebol"																	//Si el numero aleatorio es 3, el palo es treboles
				}else if (palo == 4){
					palo = "picas"																	//Si el numero aleatorio es 4, el palo es picas
				}																		//Devuelve el palo
			}

			function generarID(carta, palo){
				id = carta + palo;
			}														//Funcion para generar un ID para cada carta

			function randomizarCartas(){															//Funcion para generar una carta aleatoria
				randomizarPalo();
				randomizarCarta();
				generarID(carta, palo);		
			}

			function mostrarBotones(inicioPartida){							
					
				if (inicioPartida==true){																//Si la variable inicioPartida es 1
					carta10.classList.add("repartir1");												//Añade la clase repartir1 a la carta10
					setTimeout(function() {															//Al finalizar la animacion de la carta10
						carta10.classList.add("carta_reparto1");									//Añade la clase carta_reparto1 a la carta10
					}, 500);	
					setTimeout(function() {															//Al finalizar la animacion de la carta10
						if (carta10.classList.contains("carta_reparto1")){							//Si la carta10 tiene la clase carta_reparto1
							carta9.classList.add("repartir2");										//Añade la clase repartir2 a la carta9
						}}, 1000);
					setTimeout(function() {															//Al finalizar la animacion de la carta9	
						carta9.classList.add("carta_reparto2");										//Añade la clase carta_reparto2 a la carta9
						voltearCarta1();															//Llamada a la funcion voltearCarta1
					}, 1500);
					
				}
			}
			
			function voltearCarta1(){																//Funcion para voltear la carta1
				randomizarCartas();																	//Llamada a la funcion randomizarCartas
				cartaJugador1 = new cartaJuego(palo, carta, valor, id);									//Crea una nueva instancia de la clase cartaJuego
				cartaJugador1.owned = true;															//Asigna el valor true a la propiedad owned de la instancia cartaJugador1
				console.log(cartaJugador1);
				if (carta9.classList.contains("carta_reparto2")){									//Si la carta9 tiene la clase carta_reparto2
					carta10.classList.remove("repartir1");											//Elimina la clase repartir1 de la carta10
					carta10.classList.add("voltear_carta1");										//Añade la clase voltear_carta1 a la carta10
					carta10.addEventListener("animationend", function(){							//Al finalizar la animacion de la carta10					
						naipe10.src = "deck/"+cartaJugador1.carta+cartaJugador1.palo+".png";		//Cambia la imagen de la carta10
						carta10.classList.remove("voltear_carta1");									//Elimina la clase voltear_carta1 de la carta10
						carta10.classList.add("voltear_carta1-2");									//Añade la clase voltear_carta1-2 a la carta10
						carta10.addEventListener("animationend", function(){						//Al finalizar la animacion de la carta10
						voltearCarta2();															//Llamada a la funcion voltearCarta2
						});
					});
				}
			}
			function voltearCarta2(){
				randomizarCartas();
				cartaJugador2 = new cartaJuego(palo, carta, valor, id); 
				if (cartaJugador1.id == cartaJugador2.id){											//Si la carta1 es igual a la carta2
					randomizarCartas();
					cartaJugador2 = new cartaJuego(palo, carta, valor, id); 
				}else{
				cartaJugador2.owned = true;
				console.log(cartaJugador2);
				if (carta10.classList.contains("votear_carta1-2"))
					carta9.classList.remove("repartir2");
					carta9.classList.add("voltear_carta1");	
					carta9.addEventListener("animationend", function(){
						naipe9.src = "deck/"+cartaJugador2.carta+cartaJugador2.palo+".png";
						carta9.classList.remove("voltear_carta1");
						carta9.classList.add("voltear_carta1-2");
						carta9.addEventListener("animationend", function(){
							pedir_carta.classList.add("mostrar_boton");
						})
					});
				}
			}

			function voltearCarta3(){
				randomizarCartas();
				cartaJugador3 = new cartaJuego(palo, carta, valor, id); 
				if ((cartaJugador1.id == cartaJugador3.id)&&(cartaJugador2.id == cartaJugador3.id)){  //Si la carta1 es igual a la carta3
					randomizarCartas();
					cartaJugador3 = new cartaJuego(palo, carta, valor, id); 
				}else{
				cartaJugador3.owned = true;
				console.log(cartaJugador3);
				if (carta9.classList.contains("votear_carta1-2"))
					carta9.classList.remove("repartir2");
					setTimeout(function(){
					carta8.classList.add("voltear_carta1");	
					carta8.addEventListener("animationend", function(){
						naipe8.src = "deck/"+cartaJugador3.carta+cartaJugador3.palo+".png";
						carta8.classList.remove("voltear_carta1");
						carta8.classList.add("voltear_carta1-2");
					}), 1000;
					});
				}}	
				
				function voltearCarta4(){
				randomizarCartas();
				cartaJugador4 = new cartaJuego(palo, carta, valor, id); 
				if ((cartaJugador1.id==cartaJugador4.id)&&(cartaJugador2.id==cartaJugador3.id)&&(cartaJugador3.id==cartaJugador4.id)){  //Si la carta1 es igual a la carta3
					randomizarCartas();
					cartaJugador4 = new cartaJuego(palo, carta, valor, id); 
				}else{
				cartaJugador4.owned = true;
				console.log(cartaJugador4);
				if (carta8.classList.contains("votear_carta1-2"))
					carta8.classList.remove("repartir3");
					setTimeout(function(){
					carta7.classList.add("voltear_carta1");	
					carta7.addEventListener("animationend", function(){
						naipe7.src = "deck/"+cartaJugador4.carta+cartaJugador4.palo+".png";
						carta7.classList.remove("voltear_carta1");
						carta7.classList.add("voltear_carta1-2");
					}), 1000;
					});
				}}					
			function pideCarta(){
				if(carta9.classList.contains("carta_reparto2")){	
				carta8.classList.add("repartir3");
				setTimeout(function() {
						carta8.classList.add("carta_reparto3");
						voltearCarta3();
				}, 500);
				}
				if (carta8.classList.contains("carta_reparto3")){
					carta7.classList.add("repartir4");
					setTimeout(function() {
						carta7.classList.add("carta_reparto4");
						voltearCarta4();
				}, 500);	
				}

					
						
					
				}
																		
								


			
			
			
			
	</script>
</html>